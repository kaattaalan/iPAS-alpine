<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="iPAS.it - Your Pocket Todo List">

  <title>iPAS - Inspired Pass Allocation System</title>

  <script src="js/pocketbase.umd.js"></script>
  <script src="js/install_pwa.js"></script>
  <script src="js/alpine-framework.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.12.0/dist/cdn.min.js"></script>

  <link rel="stylesheet" href="css/pico.min.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="manifest" href="manifest.json">
</head>

<body>
  <div x-data="lists" class="container">
    <nav>
      <ul>
        <li>
          <h1 @click="selectedList = null" style="margin:0; text-align: center; cursor: pointer">iPAS</h1>
        </li>
      </ul>
      <ul>
        <li><i @click="installPWA()" id="install-prompt" class="bx bx-download bx-md"
            style="cursor: pointer; display: none;"></i>
        </li>
        <li><i @click="requestPermission()" id="notify-prompt" class="bx bxs-bell bx-md"
            style="cursor: pointer; display: block;"></i>
        </li>
        <li><i x-show="!showLogin" @click="logout()" class="bx bx-log-out bx-md" style="cursor: pointer"></i></li>
      </ul>
    </nav>

    <!-- login / signup -->
    <article x-show="showLogin" x-transition>
      <div x-data="{ showSignup: false }">

        <form x-show="!showSignup">
          <h2>Login</h2>
          <label for="email">Email</label>
          <input x-model="email" type="email" id="loginEmail" placeholder="Email address">

          <label for="password">Password</label>
          <input x-model="password" type="password" id="loginPassword">

          <button @click.prevent="login()" class="contrast outline">Login</button>
          <mark x-show="loginMessage" class="small" x-text="loginMessage"></mark>

          <button type="button" @click.prevent="showSignup = true">Sign Up</button>
        </form>

        <template x-if="showSignup">
          <div>
            <h2>Signup</h2>

            <form>
              <label for="email">Email</label>
              <input x-model="email" type="email" id="email" placeholder="Email address">

              <label for="password">Password</label>
              <input x-model="password" type="password" id="password">

              <label for="passwordConfirm">Confirm Password</label>
              <input x-model="passwordConfirm" type="password" id="passwordConfirm">

              <a href="#" @click.prevent="signup()" class="contrast outline" role="button">Signup</a>
              <a href="#" @click.prevent="showSignup = false" role="button">Login</a>

            </form>

            <mark x-show="signupMessage" class="small" x-text="signupMessage"></mark>
          </div>
        </template>
      </div>


    </article>

    <!-- show lists -->
    <article x-show="!showLogin && !selectedList" x-transition style="margin-top: 10%;">
      <h2>Your Lists</h2>

      <template x-for="list in lists">
        <div style="display:flex; justify-content: space-between; margin-top: 1rem">
          <u><strong x-text="list.name" @click="selectList(list)" style="cursor: pointer;"></strong></u>
          <i @click="deleteList(list)" class="bx bx-trash bx-sm" style="text-align: end; cursor: pointer"></i>
        </div>
      </template>

      <hr style="margin: 2rem">
      </hr>

      <label for="newList">Create New List</label>
      <input x-model="newListName" id="newList" type="newList" placeholder="List Name">
      <button @click="createList" class="contrast outline">Create</button>

    </article>

    <!-- show selectedList items -->
    <article x-show="!showLogin && selectedList" x-transition style="margin-top: 10%;">
      <h2>Test</h2>

      <template x-for="item in items">
        <div style="display:flex; justify-content: space-between; margin-top: 1rem">
          <label for="check">
            <input x-model="item.done" @change="e => toggleDone(item, e.target.checked)" type="checkbox" id="check">
            <strong x-text="item.text"></strong>
          </label>
          <i @click="deleteItem(item)" class="bx bx-trash bx-sm" style="text-align: end; cursor: pointer"></i>
        </div>
      </template>

      <hr style="margin: 2rem">
      </hr>

      <label for="newItem">Create New Item</label>
      <input x-model="newItem" id="newItem" type="newItem" placeholder="What do you want to iPAS?">
      <button @click="createItem" class="contrast outline">Create</button>

      <hr style="margin: 1rem;">
      </hr>

      <button @click="selectedList = null" class="primary outline">Back</button>

    </article>
  </div>

</body>

</html>